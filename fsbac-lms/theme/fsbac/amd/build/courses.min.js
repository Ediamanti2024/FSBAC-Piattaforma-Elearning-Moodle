define("theme_fsbac/courses",["exports","jquery","theme_fsbac/filters","core/templates"],(function(_exports,_jquery,Filters,Templates){var obj;function _getRequireWildcardCache(nodeInterop){if("function"!=typeof WeakMap)return null;var cacheBabelInterop=new WeakMap,cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop})(nodeInterop)}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule)return obj;if(null===obj||"object"!=typeof obj&&"function"!=typeof obj)return{default:obj};var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if("default"!==key&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}return newObj.default=obj,cache&&cache.set(obj,newObj),newObj}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_jquery=(obj=_jquery)&&obj.__esModule?obj:{default:obj},Filters=_interopRequireWildcard(Filters),Templates=_interopRequireWildcard(Templates);let OFFSET_PAGINATION=12;let courses=[],coursesFilters=[],currentPage=1;const TYPE_FILTER_ORDER="order",TYPE_FILTER_TEXT="text",TYPE_FILTER_TAG="tag",TYPE_FILTER_PROGRAM="program",TYPE_FILTER_TEACHERS="teachers",TYPE_FILTER_TYPE="type",TYPE_FILTER_TIME="time",TYPE_FILTER_PATHS="paths",TYPE_FILTER_LEVEL="level",TYPE_FILTER_DURATION="duration",TYPE_FILTER_CERTICATE="certificate";let filterSet={};const setPagination=()=>{const total=coursesFilters.length;if(0!==total&&total>OFFSET_PAGINATION){const numPages=Math.ceil(total/OFFSET_PAGINATION),pages=[];for(let i=1;i<=numPages;i++)pages.push({active:i===currentPage,page:i});const disabledNext=currentPage===numPages,disabledPrev=1===currentPage,container=(0,_jquery.default)(".fsbac-pagination-container");Templates.render("theme_fsbac/components/pagination/index",{pages:pages,disabledNext:disabledNext,disabledPrev:disabledPrev}).then(((html,js)=>{Templates.replaceNodeContents(container,html,js)}))}else(0,_jquery.default)(".fsbac-pagination-container").hide();setViewCourses()},setViewCourses=()=>{const start=(currentPage-1)*OFFSET_PAGINATION,end=currentPage*OFFSET_PAGINATION,courses=coursesFilters.slice(start,end),isPath=(0,_jquery.default)("#page-theme-fsbac-pages-paths").length>0,container=(0,_jquery.default)(".fsbac-cards-courses"),tmp=isPath?"theme_fsbac/pages/paths/view":"theme_fsbac/pages/courses/view";Templates.render(tmp,{courses:courses}).then(((html,js)=>{Templates.replaceNodeContents(container,html,js)}))},setFilter=(type,value)=>{filterSet={...filterSet,[type]:value},value&&"-"!==value||delete filterSet[type];let courses=[...c];Object.keys(filterSet).forEach((key=>{const value=filterSet[key];courses=applyFilter(key,value,courses)})),coursesFilters=[...courses]},applyFilter=(type,value,coursesNew)=>{if(type===TYPE_FILTER_ORDER){const values=filtersByOrder(coursesNew,value);values&&(coursesNew=[...values])}if(type===TYPE_FILTER_TAG){const values=filtersByTag(coursesNew,value);values&&(coursesNew=[...values])}if(type===TYPE_FILTER_PROGRAM){const values=filtersByProgram(coursesNew,value);values&&(coursesNew=[...values])}if(type===TYPE_FILTER_TEACHERS){const values=filtersByTeachers(coursesNew,value);values&&(coursesNew=[...values])}if(type===TYPE_FILTER_TYPE){const values=filtersByType(coursesNew,value);values&&(coursesNew=[...values])}if(type===TYPE_FILTER_TIME){const values=filtersByTime(coursesNew,value);values&&(coursesNew=[...values])}if(type===TYPE_FILTER_PATHS){const values=filtersByPath(coursesNew,value);values&&(coursesNew=[...values])}if(type===TYPE_FILTER_LEVEL){const values=filtersByLevel(coursesNew,value);values&&(coursesNew=[...values])}if(type===TYPE_FILTER_DURATION){const values=filtersByDuration(coursesNew,value);values&&(coursesNew=[...values])}if(type===TYPE_FILTER_CERTICATE){const values=filtersByCerticate(coursesNew,value);values&&(coursesNew=[...values])}return type===TYPE_FILTER_TEXT&&value&&(coursesNew=[...filtersByText(coursesNew,value)]),[...coursesNew]},filterSelect=e=>{const current$=(0,_jquery.default)(e.currentTarget),type=current$.data("type"),elmType=(0,_jquery.default)(e.currentTarget).attr("type");let value=current$.val();"checkbox"===elmType&&(value=(0,_jquery.default)(e.currentTarget).prop("checked")),setFilter(type,value)},filtersByText=(courses,value)=>{const rg=new RegExp(value,"gi");return courses.filter((_ref=>{let{fullname:fullname}=_ref;return-1!==fullname.search(rg)}))},filtersByProgram=(courses,value)=>{if("-"===value)return null;const rg=new RegExp(value,"gi");return courses.filter((_ref2=>{let{programma:programma}=_ref2;return-1!==(programma||"").search(rg)}))},filtersByTeachers=(courses,value)=>{if("-"===value)return null;const rg=new RegExp(value,"gi");return courses.filter((_ref3=>{let{autore:autore}=_ref3;return-1!==(autore||"").search(rg)}))},filtersByTag=(courses,value)=>"-"===value?null:courses.filter((_ref4=>{let{tags:tags}=_ref4;return tags.some((tag=>tag===value))})),filtersByPath=(courses,value)=>"-"===value?null:courses.filter((_ref5=>{let{paths:paths}=_ref5;return paths.some((p=>p.toString()===value))})),filtersByTime=(courses,value)=>"-"===value?null:courses.filter((_ref6=>{let{enddate_fascia:enddate_fascia}=_ref6;return enddate_fascia===value})),filtersByType=(courses,value)=>"-"===value?null:courses.filter((_ref7=>{let{tipologia:tipologia}=_ref7;return tipologia===value})),filtersByLevel=(courses,value)=>"-"===value?null:courses.filter((_ref8=>{let{livello:livello}=_ref8;return livello===value})),filtersByDuration=(courses,value)=>courses.filter((_ref9=>{let{duration:duration}=_ref9;return duration>=value.start&&duration<=value.end})),filtersByCerticate=(courses,value)=>value?courses.filter((_ref10=>{let{isCertificate:isCertificate}=_ref10;return isCertificate})):courses,filtersByOrder=(courses,value)=>"-"===value?null:"date_start"===value?courses.sort((function(a,b){return a.startdate-b.startdate})):"a_z"===value?courses.sort(((a,b)=>a.fullname.localeCompare(b.fullname,"es",{sensitivity:"base"}))):"z_a"===value?courses.sort(((a,b)=>a.fullname.localeCompare(b.fullname,"es",{sensitivity:"base"}))).reverse():null,submitFilter=()=>{if((0,_jquery.default)(".fsbac-cards-courses").show(),(0,_jquery.default)(".fsbac-empty-values").hide(),Filters.closeFilter(),setPagination(),0===coursesFilters.length)return(0,_jquery.default)(".fsbac-empty-values").show(),void(0,_jquery.default)(".fsbac-cards-courses").hide()};_exports.init=(c,config)=>{const{offset:offset,params:params}=config||{};offset&&(OFFSET_PAGINATION=offset),courses=c,window.c=courses,coursesFilters=[...c],Filters.initEvent(),Filters.initFilterSliderRange("slider-1","slider-2",(value=>{setFilter(TYPE_FILTER_DURATION,value)})),(0,_jquery.default)(".fsbac-select-fiters").on("change","select",filterSelect),(0,_jquery.default)(".fsbac-filters-input-search").on("keyup","input",filterSelect),(0,_jquery.default)(".fsbac-filters-input-search").on("keyup","input",(event=>{69===event.key.charCodeAt()&&submitFilter()})),(0,_jquery.default)(".fsbac-filters-checkbox").on("change","input",filterSelect),(0,_jquery.default)(".fsbac-filters-input-search").on("click",".submit-filter",(()=>{submitFilter()})),(0,_jquery.default)(".fsbac-pagination-container").on("click",".fsbac-button-pagination",(e=>{const page=(0,_jquery.default)(e.currentTarget).data("page");"next"===page&&(currentPage+=1),"prev"===page&&(currentPage-=1),"prev"!==page&&"next"!==page&&(currentPage=page),setPagination()})),params&&Object.keys(params).map((key=>{const value=params[key];(0,_jquery.default)(".form-group #".concat(key)).val(value),setFilter(key,value)})),setPagination()}}));

//# sourceMappingURL=courses.min.js.map